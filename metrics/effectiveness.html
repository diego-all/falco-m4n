<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Falcom4n</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .navbar-center {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
    }
    .navbar-end {
      margin-left: auto;
    }
    #conventions {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #f9f9f9;
            text-align: center;
        }

        #conventions h3 {
            text-align: center;
            margin-bottom: 15px;
        }

        #conventions .button-container {
            display: flex;
            justify-content: center;
            gap: 10px;
        }

        #conventions button {
            margin: 5px;
            padding: 10px;
            border: none;
            border-radius: 3px;
            background-color: #007bff;
            color: white;
            cursor: pointer;
        }

        #conventions button:hover {
            background-color: #0056b3;
        }

        #conventions-info {
        margin-top: 10px;
        font-size: 14px;
        color: #333;
        max-width: 400px;
        text-align: center; /* Asegura que el texto esté centrado */
        margin-left: auto; /* Centrado horizontal */
        margin-right: auto; /* Centrado horizontal */
        }

footer {
        background-color: #000000;
        color: white;
        padding: 20px 0;
        text-align: center;
    }
    footer img {
        max-width: 100px;
        margin-bottom: 10px;
    }
    footer p {
        margin: 0;
    }
    .button-container {
      display: flex;
      justify-content: center;
      width: 50%; /* Ajusta el ancho según tus necesidades */
      margin: 0 auto;
    }
  </style>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
      <!-- Logo -->
      <a class="navbar-brand" href="../index.html">Falcom4n</a>

      <!-- Navbar Toggle -->
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <!-- Navbar Content -->
      <div class="collapse navbar-collapse" id="navbarNavDropdown">
        <!-- Centered Links -->
        <ul class="navbar-nav navbar-center">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="index.html">Home</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="infoDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Info
            </a>
            <ul class="dropdown-menu" aria-labelledby="infoDropdown">
              <li><a class="dropdown-item" href="../info/what-is-falco.html">What Is Falco</a></li>
              <li><a class="dropdown-item" href="../info/why-falco.html">Why Falco</a></li>
              <li><a class="dropdown-item" href="../info/use-cases.html">Use cases</a></li>
            </ul>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="rulesDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Rules
            </a>
            <ul class="dropdown-menu" aria-labelledby="rulesDropdown">
              <li><a class="dropdown-item" href="../rules/community-rules.html">Community Rules</a></li>
              <li><a class="dropdown-item" href="../rules/custom-rules.html">Custom Rules</a></li>
              <li><a class="dropdown-item" href="../rules/vendor-rules.html">Vendor Rules</a></li>
              <li><a class="dropdown-item" href="../rules/irt-alert-rules.html">IRT_Alert Rules</a></li>
            </ul>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="metricsDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Metrics
            </a>
            <ul class="dropdown-menu" aria-labelledby="metricsDropdown">
              <li><a class="dropdown-item" href="../metrics/statistics.html">Statistics</a></li>
              <li><a class="dropdown-item" href="../metrics/security-coverage.html">Security Coverage</a></li>
              <li><a class="dropdown-item" href="../metrics/maturity.html">Maturity</a></li>
              <li><a class="dropdown-item" href="../effectiveness.html">Effectiveness</a></li>
            </ul>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="securityDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Security
            </a>
            <ul class="dropdown-menu" aria-labelledby="securityDropdown">
              <li><a class="dropdown-item" href="../security/threats.html">Threats</a></li>
              <li><a class="dropdown-item" href="../security/workshop.html">Workshop</a></li>
              <li><a class="dropdown-item" href="../security/bypasses.html">Bypasses</a></li>
              <li><a class="dropdown-item" href="../security/challenges.html">Challenges</a></li>
            </ul>
          </li>
        </ul>

        <!-- About Link -->
        <ul class="navbar-nav navbar-end">
          <li class="nav-item">
            <a class="nav-link" href="about.html">About</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>


  <!-- Content Section -->
  <div class="container mt-5">
    <h1>Effectiveness</h1>
    <p>The effectiveness of the rules in a security tool like Falco involves evaluating how well the rules detect relevant incidents and prevent false positives. Below is a structured approach to calculate this effectiveness:</p>
  
    <div class="container mt-5">
      <h1></h1>
      <div class="button-container">
        <button class="btn btn-primary" type="button" data-bs-toggle="collapse" data-bs-target="#rulesTable" aria-expanded="false" aria-controls="rulesTable">
          View most accurate rules table
        </button>
      </div>
  
    </div>

    <h3>Challenge</h3>

    <p>Calculating the effectiveness of each Falco rule in terms of its precision presents several challenges today. It requires information that is currently unavailable, such as the resolution of all events generated by Falco and their corresponding false positive and false negative rates. This information must be provided by the Incident Response Team (IRT).</p>

    <br>
    <br>


    <!-- Si la grafica se ve muy pequeña puede salir del contenedor para que ocupe todo el ancho -->


    <div class="collapse mt-3" id="rulesTable">
      <div class="table-responsive">
          <table class="table table-bordered">
              <thead class="table-dark">
                  <tr>
                      <th>Rule</th>
                      <th>Alert Status</th>
                      <th>Bee Queen</th>
                      <th>Behavior</th>
                      <th>Annual Events</th>
                      <th>True Positive (TP)</th>
                      <th>False Positive (FP)</th>
                      <th>Mala Practica (Vulnman)</th>
                  </tr>
              </thead>
              <tbody>
                  <tr>
                      <td>Directory traversal monitored file read</td>
                      <td>IRT_Alert</td>
                      <td></td>
                      <td>Si</td>
                      <td>4</td>
                      <td>2</td>
                      <td>2</td>
                      <td>solved</td>
                  </tr>
                  <tr>
                      <td>Read sensitive file trusted after startup</td>
                      <td>IRT_Alert</td>
                      <td></td>
                      <td>Si</td>
                      <td>2</td>
                      <td>0</td>
                      <td>2</td>
                      <td>solved</td>
                  </tr>
                  <tr>
                      <td>Program run with disallowed http proxy env</td>
                      <td>IRT_Alert</td>
                      <td></td>
                      <td>Si</td>
                      <td>0</td>
                      <td>0</td>
                      <td>0</td>
                      <td>solved</td>
                  </tr>
                  <tr>
                      <td>Search Private Keys or Passwords</td>
                      <td>IRT_Alert</td>
                      <td></td>
                      <td>Si</td>
                      <td>2</td>
                      <td>2</td>
                      <td>0</td>
                      <td>solved</td>
                  </tr>
                  <tr>
                      <td>Remove Bulk Data from Disk</td>
                      <td>IRT_Alert</td>
                      <td></td>
                      <td>Si</td>
                      <td>0</td>
                      <td>0</td>
                      <td>0</td>
                      <td>solved</td>
                  </tr>
                  <tr>
                      <td>Detect crypto miners using the Stratum protocol</td>
                      <td>IRT_Alert</td>
                      <td></td>
                      <td>Si</td>
                      <td>0</td>
                      <td>0</td>
                      <td>0</td>
                      <td>solved</td>
                  </tr>
                  <!-- Add the remaining rules similarly -->
                  <tr>
                    <td>Packet socket created in container</td>
                    <td>IRT_Alert</td>
                    <td></td>
                    <td>No</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>solved</td>
                  </tr>
                  <tr>
                    <td>Container Drift Detected (chmod)</td>
                    <td>IRT_Alert</td>
                    <td></td>
                    <td>No</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>solved</td>
                  </tr>
                  <tr>
                    <td>Container Drift Detected (open+create)</td>
                    <td>IRT_Alert</td>
                    <td></td>
                    <td>No</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>solved</td>
                  </tr>
                  <tr>
                    <td>Outbound Connection to C2 Servers </td>
                    <td>IRT_Alert</td>
                    <td></td>
                    <td>Si</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>solved</td>
                  </tr>
                  <tr>
                    <td>Linux Kernel Module Injection Detected</td>
                    <td>IRT_Alert</td>
                    <td></td>
                    <td>Si</td>
                    <td>4</td>
                    <td>2</td>
                    <td>2</td>
                    <td>solved</td>
                  </tr>
                  <tr>
                    <td>Sudo Potential Privilege Escalation</td>
                    <td>IRT_Alert</td>
                    <td></td>
                    <td>Si</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>solved</td>
                  </tr>
                  <tr>
                    <td>Debugfs Launched in Privileged Container</td>
                    <td>IRT_Alert</td>
                    <td></td>
                    <td>Si</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>solved</td>
                  </tr>
                  <tr>
                    <td>Unprivileged Delegation of Page Faults Handling to a Userspace Process</td>
                    <td>IRT_Alert</td>
                    <td></td>
                    <td>No</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>solved</td>
                  </tr>
                  <tr>
                    <td>Polkit Local Privilege Escalation Vulnerability (CVE-2021-4034)</td>
                    <td>IRT_Alert</td>
                    <td></td>
                    <td>Si</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>solved</td>
                  </tr>
                  <tr>
                    <td>Detect release_agent File Container Escapes</td>
                    <td>IRT_Alert</td>
                    <td></td>
                    <td>Si</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>solved</td>
                  </tr>
              </tbody>
          </table>
      </div>
  </div>
</div>
  
  

  </div>

        


  <!-- Content Section -->
  <div class="container mt-5">
    <h2>Individual effectiveness per rule</h2>
    <p>The individual effectiveness of each rule is presented based on the number of low false positives. This information is calculated using the events generated by Falco at MELI during 2024. Below are the 16 least noisy rules.</p>
  
    <!-- <h1>Individual effectiveness per rule</h1> -->
<div style="width: 80%; margin: auto;"></div>
  <canvas id="falcoChart"></canvas>
</div>

<div id="conventions">
  <h3>Convenciones</h3>
  <button onclick="showInfo('annualEvents')">Eventos Anuales</button>
  <button onclick="showInfo('truePositives')">Tasa de Verdaderos Positivos</button>
  <button onclick="showInfo('falsePositives')">Tasa de Falsos Positivos</button>
  <div id="conventions-info"></div>
</div>

  </div>
  <!-- Content Section -->
  <div class="container mt-5">
    <h2>Rules Effectiveness Evaluation</h2>
    <p>Falco rules enable real-time monitoring and detection of anomalous or suspicious behaviors based on a predefined set of conditions. Evaluating the effectiveness of these rules not only ensures their proper configuration but also helps optimize security coverage by identifying gaps (bypasses) in detection.</p>
  


    <div class="container mt-5">
      <div class="button-container mb-3">
        <button class="btn btn-primary" type="button" data-bs-toggle="collapse" data-bs-target="#methodologyContainer" aria-expanded="false" aria-controls="methodologyContainer">
           View Evaluation Methodology 
        </button>
      </div>
      <div class="collapse" id="methodologyContainer">

        <p>In this case, we are working with a total of 69 rules, divided as follows:</p>
        <ul>
          <li>38 Vendor rules</li>
          <li>31 Custom rules</li>
        </ul>
        <p>A thorough analysis has been conducted based on the ability of the rules to detect specific behaviors by replicating conditions associated with each one. The results are as follows:</p>
        <ul>
          <li>31 custom rules are fully effective as they successfully detect the configured behaviors.</li>
          <li>Out of the 38 vendor rules, only 30 are effective, while the remaining 8 fail to detect replicated behaviors.</li>
        </ul>

        <p>The effectiveness of each rule was assessed using a behavior-based approach:</p>
        <ul>
          <li><strong>Understanding the rule:</strong> Comprehend the activity the rule aims to detect (e.g., unauthorized socket creation, container escape attempts, or modifications to critical files).</li>
          <li><strong>Behavior replication:</strong> Simulate the conditions the rule is designed to detect, ensuring these correspond to real or potential attack scenarios.</li>
          <li><strong>Validation:</strong> Observe whether Falco generates alerts when replicating the behavior. This helps determine whether the rule is effective or requires adjustments.</li>
        </ul>
      </div>
    </div>


        <!-- Si la grafica se ve muy pequeña puede salir del contenedor para que ocupe todo el ancho -->

    <div style="width: 60%; margin: auto;">
      <canvas id="falcoEffectivenessChart"></canvas>


      <p>Las reglas no pueden ser probadas por su complejidad para generar el comportamiento, generalmente requieren desplegar infraestructura vulnerable y no es viable.</p>
    </div>

  
  </div>

  

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
  const ctx = document.getElementById('falcoChart').getContext('2d');
  const tooltip = document.getElementById('tooltip');
  const conventionsInfo = document.getElementById('conventions-info');

  function showInfo(metric) {
            let info = '';
            switch (metric) {
                case 'annualEvents':
                    info = 'Los Eventos Anuales representan el número total de ocurrencias de cada regla durante el último año.';
                    break;
                case 'truePositives':
                    info = 'La Tasa de Verdaderos Positivos indica el porcentaje de eventos anuales que fueron clasificados correctamente como positivos.';
                    break;
                case 'falsePositives':
                    info = 'La Tasa de Falsos Positivos indica el porcentaje de eventos anuales que fueron clasificados incorrectamente como positivos.';
                    break;
            }
            conventionsInfo.innerHTML = info;
        }

  // Data extracted from the table
  const rules = [
      "Directory traversal monitored file read",
      "Read sensitive file trusted after startup",
      "Program run with disallowed http proxy env",
      "Search Private Keys or Passwords",
      "Remove Bulk Data from Disk",
      "Detect crypto miners using the Stratum protocol",
      "Packet socket created in container",
      "Container Drift Detected (chmod)",
      "Container Drift Detected (open+create)",
      "Outbound Connection to C2 Servers",
      "Linux Kernel Module Injection Detected",
      "Sudo Potential Privilege Escalation",
      "Debugfs Launched in Privileged Container",
      "Unprivileged Delegation of Page Faults Handling",
      "Polkit Local Privilege Escalation (CVE-2021-4034)",
      "Detect release_agent File Container Escapes"
  ];

  const annualEvents = [4, 2, 0, 2, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0];
  const truePositives = [2, 0, 0, 2, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0];
  const falsePositives = [2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0];

  // Calculate TP and FP rates (percentage of annual events)
  const tpRate = annualEvents.map((events, index) => events > 0 ? (truePositives[index] / events) * 100 : 0);
  const fpRate = annualEvents.map((events, index) => events > 0 ? (falsePositives[index] / events) * 100 : 0);

  // Create the Chart
  const falcoChart = new Chart(ctx, {
      type: 'bar',
      data: {
          labels: rules,
          datasets: [
              {
                  label: 'Annual Events',
                  data: annualEvents,
                  backgroundColor: 'rgba(75, 192, 192, 0.6)',
                  borderColor: 'rgba(75, 192, 192, 1)',
                  borderWidth: 1
              },
              {
                  label: 'True Positive Rate (%)',
                  data: tpRate,
                  backgroundColor: 'rgba(54, 162, 235, 0.6)',
                  borderColor: 'rgba(54, 162, 235, 1)',
                  borderWidth: 1
              },
              {
                  label: 'False Positive Rate (%)',
                  data: fpRate,
                  backgroundColor: 'rgba(255, 99, 132, 0.6)',
                  borderColor: 'rgba(255, 99, 132, 1)',
                  borderWidth: 1
              }
          ]
      },
      options: {
          responsive: true,
          plugins: {
              tooltip: {
                  mode: 'index',
                  intersect: false
              },
              legend: {
                  position: 'top'
              }
          },
          scales: {
              x: {
                  beginAtZero: true,
                  ticks: {
                      autoSkip: false,
                      maxRotation: 45,
                      minRotation: 45
                  }
              },
              y: {
                  beginAtZero: true,
                  title: {
                      display: true,
                      text: 'Count / Percentage'
                  }
              }
          }
      }
  });

  function toggleRules() {
      const rulesContainer = document.getElementById('rulesContainer');
      rulesContainer.style.display = rulesContainer.style.display === 'none' || !rulesContainer.style.display ? 'block' : 'none';
    }

        function toggleMethodology() {
      const methodologyContainer = document.getElementById('methodologyContainer');
      methodologyContainer.style.display = methodologyContainer.style.display === 'none' || !methodologyContainer.style.display ? 'block' : 'none';
    }

    const ctx2 = document.getElementById('falcoEffectivenessChart').getContext('2d');

// Cálculo de porcentajes de efectividad
const vendorTotal = 38; // Total de reglas Vendor
const vendorEffective = 30; // Reglas Vendor efectivas
const vendorPercentage = ((vendorEffective / vendorTotal) * 100).toFixed(1); // Porcentaje efectivo

const customTotal = 31; // Total de reglas Custom
const customEffective = 31; // Reglas Custom efectivas
const customPercentage = ((customEffective / customTotal) * 100).toFixed(1); // Porcentaje efectivo

// Datos del gráfico
const data = {
  labels: [
    `Vendor (38 reglas, ${vendorPercentage}% efectivas)`,
    `Custom (31 reglas, ${customPercentage}% efectivas)`
  ],
  datasets: [
    {
      label: 'Probadas (Detectadas)',
      data: [vendorEffective, customEffective], // Vendor probadas, Custom probadas
      backgroundColor: 'rgba(75, 192, 192, 0.7)', // Color verde
      borderColor: 'rgba(75, 192, 192, 1)',
      borderWidth: 1,
    },
    {
      label: 'No probadas (No Detectadas)',
      data: [vendorTotal - vendorEffective, customTotal - customEffective], // Vendor y Custom no probadas
      backgroundColor: 'rgba(255, 99, 132, 0.7)', // Color rojo
      borderColor: 'rgba(255, 99, 132, 1)',
      borderWidth: 1,
    },
  ],
};

// Opciones del gráfico
const options = {
  plugins: {
    title: {
      display: true,
      text: 'Falco Rules Effectiveness Evaluation',
      font: { size: 18 },
    },
    tooltip: {
      callbacks: {
        label: function(tooltipItem) {
          return `${tooltipItem.dataset.label}: ${tooltipItem.raw}`;
        },
      },
    },
  },
  responsive: true,
  scales: {
    x: {
      stacked: true,
      title: {
        display: true,
        text: 'Rule Type',
      },
    },
    y: {
      stacked: true,
      beginAtZero: true,
      title: {
        display: true,
        text: 'Rules number',
      },
    },
  },
};

// Crear el gráfico
new Chart(ctx2, {
  type: 'bar',
  data: data,
  options: options,
});

    
</script>

</body>
<!-- Footer -->
<footer>
    <p>Falco Team</p>
    <p>Mercado Libre - Observability Security</p>
    <p>&copy; 2024</p>
</footer>
</html>
