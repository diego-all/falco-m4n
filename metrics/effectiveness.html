<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Falcom4n</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .navbar-center {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
    }
    .navbar-end {
      margin-left: auto;
    }
    #conventions {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #f9f9f9;
            text-align: center;
        }

        #conventions h3 {
            text-align: center;
            margin-bottom: 15px;
        }

        #conventions .button-container {
            display: flex;
            justify-content: center;
            gap: 10px;
        }

        #conventions button {
            margin: 5px;
            padding: 10px;
            border: none;
            border-radius: 3px;
            background-color: #007bff;
            color: white;
            cursor: pointer;
        }

        #conventions button:hover {
            background-color: #0056b3;
        }

        #conventions-info {
        margin-top: 10px;
        font-size: 14px;
        color: #333;
        max-width: 400px;
        text-align: center; /* Asegura que el texto esté centrado */
        margin-left: auto; /* Centrado horizontal */
        margin-right: auto; /* Centrado horizontal */
        }

footer {
        background-color: #000000;
        color: white;
        padding: 20px 0;
        text-align: center;
    }
    footer img {
        max-width: 100px;
        margin-bottom: 10px;
    }
    footer p {
        margin: 0;
    }
    .button-container {
      display: flex;
      justify-content: center;
      width: 50%; /* Ajusta el ancho según tus necesidades */
      margin: 0 auto;
    }
  </style>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
      <!-- Logo -->
      <a class="navbar-brand" href="#">Falcom4n</a>

      <!-- Navbar Toggle -->
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <!-- Navbar Content -->
      <div class="collapse navbar-collapse" id="navbarNavDropdown">
        <!-- Centered Links -->
        <ul class="navbar-nav navbar-center">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="index.html">Home</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="infoDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Info
            </a>
            <ul class="dropdown-menu" aria-labelledby="infoDropdown">
              <li><a class="dropdown-item" href="#">What Is Falco</a></li>
              <li><a class="dropdown-item" href="#">Why Falco</a></li>
            </ul>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="rulesDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Rules
            </a>
            <ul class="dropdown-menu" aria-labelledby="rulesDropdown">
              <li><a class="dropdown-item" href="../rules/community-rules.html">Community Rules</a></li>
              <li><a class="dropdown-item" href="../rules/custom-rules.html">Custom Rules</a></li>
              <li><a class="dropdown-item" href="../rules/vendor-rules.html">Vendor Rules</a></li>
              <li><a class="dropdown-item" href="../rules/irt-alert-rules.html">IRT_Alert Rules</a></li>
            </ul>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="metricsDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Metrics
            </a>
            <ul class="dropdown-menu" aria-labelledby="metricsDropdown">
              <li><a class="dropdown-item" href="statistics.html">Statistics</a></li>
              <li><a class="dropdown-item" href="security-coverage.html">Security Coverage</a></li>
              <li><a class="dropdown-item" href="maturity.html">Maturity</a></li>
              <li><a class="dropdown-item" href="effectiveness.html">Effectiveness</a></li>
            </ul>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="securityDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Security
            </a>
            <ul class="dropdown-menu" aria-labelledby="securityDropdown">
              <li><a class="dropdown-item" href="security/threats.html">Threats</a></li>
              <li><a class="dropdown-item" href="security/bypasses.html">Bypasses</a></li>
              <li><a class="dropdown-item" href="security/challenges.html">Challenges</a></li>
            </ul>
          </li>
        </ul>

        <!-- About Link -->
        <ul class="navbar-nav navbar-end">
          <li class="nav-item">
            <a class="nav-link" href="about.html">About</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>


  <!-- Content Section -->
  <div class="container mt-5">
    <h1>Effectiveness</h1>
    <p>Calcular la efectividad de las reglas de una herramienta de seguridad como Falco implica evaluar qué tan bien las reglas detectan incidentes relevantes y evitan falsos positivos. Aquí tienes un enfoque estructurado para calcular esta efectividad:</p>
  
    <div class="container mt-5">
      <h1></h1>
      <div class="button-container">
        <button class="btn btn-primary" type="button" data-bs-toggle="collapse" data-bs-target="#rulesTable" aria-expanded="false" aria-controls="rulesTable">
          View effectiveness metrics
        </button>
      </div>
  
    </div>

    <h1>Individual effectiveness</h1>
    Determinar la efectividad de una regla individual en Falco implica evaluar su capacidad para cumplir con su propósito en términos de detección de amenazas específicas, 
  
  
    Se necesitan unas tasas:
  
    True Positive Rate - TPR por ende se requiere informacion que no se tiene a dia de hoy. Depende de una sinergia con IRT)
  
    Se puede utilizar un approach basado en una muaestra.
  
    Configurar el Entorno de Pruebas
  
    Simular algunos escenarios 8Es valido?

    <br>
    <br>


    Si la grafica se ve muy pequeña puede salir del contenedor para que ocupe todo el ancho


    <div class="collapse mt-3" id="rulesTable">
      <div class="table-responsive">
          <table class="table table-bordered">
              <thead class="table-dark">
                  <tr>
                      <th>Rule</th>
                      <th>Alert Status</th>
                      <th>Bee Queen</th>
                      <th>Behavior</th>
                      <th>Annual Events</th>
                      <th>True Positive (TP)</th>
                      <th>False Positive (FP)</th>
                      <th>Mala Practica (Vulnman)</th>
                  </tr>
              </thead>
              <tbody>
                  <tr>
                      <td>Directory traversal monitored file read</td>
                      <td>IRT_Alert</td>
                      <td></td>
                      <td>Si</td>
                      <td>4</td>
                      <td>2</td>
                      <td>2</td>
                      <td>solved</td>
                  </tr>
                  <tr>
                      <td>Read sensitive file trusted after startup</td>
                      <td>IRT_Alert</td>
                      <td></td>
                      <td>Si</td>
                      <td>2</td>
                      <td>0</td>
                      <td>2</td>
                      <td>solved</td>
                  </tr>
                  <tr>
                      <td>Program run with disallowed http proxy env</td>
                      <td>IRT_Alert</td>
                      <td></td>
                      <td>Si</td>
                      <td>0</td>
                      <td>0</td>
                      <td>0</td>
                      <td>solved</td>
                  </tr>
                  <tr>
                      <td>Search Private Keys or Passwords</td>
                      <td>IRT_Alert</td>
                      <td></td>
                      <td>Si</td>
                      <td>2</td>
                      <td>2</td>
                      <td>0</td>
                      <td>solved</td>
                  </tr>
                  <tr>
                      <td>Remove Bulk Data from Disk</td>
                      <td>IRT_Alert</td>
                      <td></td>
                      <td>Si</td>
                      <td>0</td>
                      <td>0</td>
                      <td>0</td>
                      <td>solved</td>
                  </tr>
                  <tr>
                      <td>Detect crypto miners using the Stratum protocol</td>
                      <td>IRT_Alert</td>
                      <td></td>
                      <td>Si</td>
                      <td>0</td>
                      <td>0</td>
                      <td>0</td>
                      <td>solved</td>
                  </tr>
                  <!-- Add the remaining rules similarly -->
                  <tr>
                    <td>Packet socket created in container</td>
                    <td>IRT_Alert</td>
                    <td></td>
                    <td>No</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>solved</td>
                  </tr>
                  <tr>
                    <td>Container Drift Detected (chmod)</td>
                    <td>IRT_Alert</td>
                    <td></td>
                    <td>No</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>solved</td>
                  </tr>
                  <tr>
                    <td>Container Drift Detected (open+create)</td>
                    <td>IRT_Alert</td>
                    <td></td>
                    <td>No</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>solved</td>
                  </tr>
                  <tr>
                    <td>Outbound Connection to C2 Servers </td>
                    <td>IRT_Alert</td>
                    <td></td>
                    <td>Si</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>solved</td>
                  </tr>
                  <tr>
                    <td>Linux Kernel Module Injection Detected</td>
                    <td>IRT_Alert</td>
                    <td></td>
                    <td>Si</td>
                    <td>4</td>
                    <td>2</td>
                    <td>2</td>
                    <td>solved</td>
                  </tr>
                  <tr>
                    <td>Sudo Potential Privilege Escalation</td>
                    <td>IRT_Alert</td>
                    <td></td>
                    <td>Si</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>solved</td>
                  </tr>
                  <tr>
                    <td>Debugfs Launched in Privileged Container</td>
                    <td>IRT_Alert</td>
                    <td></td>
                    <td>Si</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>solved</td>
                  </tr>
                  <tr>
                    <td>Unprivileged Delegation of Page Faults Handling to a Userspace Process</td>
                    <td>IRT_Alert</td>
                    <td></td>
                    <td>No</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>solved</td>
                  </tr>
                  <tr>
                    <td>Polkit Local Privilege Escalation Vulnerability (CVE-2021-4034)</td>
                    <td>IRT_Alert</td>
                    <td></td>
                    <td>Si</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>solved</td>
                  </tr>
                  <tr>
                    <td>Detect release_agent File Container Escapes</td>
                    <td>IRT_Alert</td>
                    <td></td>
                    <td>Si</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>solved</td>
                  </tr>
              </tbody>
          </table>
      </div>
  </div>
</div>
  
  

  </div>

        


  <!-- Content Section -->
  <div class="container mt-5">
    <h1>Individual effectiveness per rule</h1>
    <p>Calcular la efectividad de las reglas de una herramienta de seguridad como Falco implica evaluar qué tan bien las reglas detectan incidentes relevantes y evitan falsos positivos. Aquí tienes un enfoque estructurado para calcular esta efectividad:</p>
  
    <!-- <h1>Individual effectiveness per rule</h1> -->
<div style="width: 80%; margin: auto;"></div>
  <canvas id="falcoChart"></canvas>
</div>

<div id="conventions">
  <h3>Convenciones</h3>
  <button onclick="showInfo('annualEvents')">Eventos Anuales</button>
  <button onclick="showInfo('truePositives')">Tasa de Verdaderos Positivos</button>
  <button onclick="showInfo('falsePositives')">Tasa de Falsos Positivos</button>
  <div id="conventions-info"></div>
</div>

  </div>






<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
  const ctx = document.getElementById('falcoChart').getContext('2d');
  const tooltip = document.getElementById('tooltip');
  const conventionsInfo = document.getElementById('conventions-info');

  function showInfo(metric) {
            let info = '';
            switch (metric) {
                case 'annualEvents':
                    info = 'Los Eventos Anuales representan el número total de ocurrencias de cada regla durante el último año.';
                    break;
                case 'truePositives':
                    info = 'La Tasa de Verdaderos Positivos indica el porcentaje de eventos anuales que fueron clasificados correctamente como positivos.';
                    break;
                case 'falsePositives':
                    info = 'La Tasa de Falsos Positivos indica el porcentaje de eventos anuales que fueron clasificados incorrectamente como positivos.';
                    break;
            }
            conventionsInfo.innerHTML = info;
        }

  // Data extracted from the table
  const rules = [
      "Directory traversal monitored file read",
      "Read sensitive file trusted after startup",
      "Program run with disallowed http proxy env",
      "Search Private Keys or Passwords",
      "Remove Bulk Data from Disk",
      "Detect crypto miners using the Stratum protocol",
      "Packet socket created in container",
      "Container Drift Detected (chmod)",
      "Container Drift Detected (open+create)",
      "Outbound Connection to C2 Servers",
      "Linux Kernel Module Injection Detected",
      "Sudo Potential Privilege Escalation",
      "Debugfs Launched in Privileged Container",
      "Unprivileged Delegation of Page Faults Handling",
      "Polkit Local Privilege Escalation (CVE-2021-4034)",
      "Detect release_agent File Container Escapes"
  ];

  const annualEvents = [4, 2, 0, 2, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0];
  const truePositives = [2, 0, 0, 2, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0];
  const falsePositives = [2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0];

  // Calculate TP and FP rates (percentage of annual events)
  const tpRate = annualEvents.map((events, index) => events > 0 ? (truePositives[index] / events) * 100 : 0);
  const fpRate = annualEvents.map((events, index) => events > 0 ? (falsePositives[index] / events) * 100 : 0);

  // Create the Chart
  const falcoChart = new Chart(ctx, {
      type: 'bar',
      data: {
          labels: rules,
          datasets: [
              {
                  label: 'Annual Events',
                  data: annualEvents,
                  backgroundColor: 'rgba(75, 192, 192, 0.6)',
                  borderColor: 'rgba(75, 192, 192, 1)',
                  borderWidth: 1
              },
              {
                  label: 'True Positive Rate (%)',
                  data: tpRate,
                  backgroundColor: 'rgba(54, 162, 235, 0.6)',
                  borderColor: 'rgba(54, 162, 235, 1)',
                  borderWidth: 1
              },
              {
                  label: 'False Positive Rate (%)',
                  data: fpRate,
                  backgroundColor: 'rgba(255, 99, 132, 0.6)',
                  borderColor: 'rgba(255, 99, 132, 1)',
                  borderWidth: 1
              }
          ]
      },
      options: {
          responsive: true,
          plugins: {
              tooltip: {
                  mode: 'index',
                  intersect: false
              },
              legend: {
                  position: 'top'
              }
          },
          scales: {
              x: {
                  beginAtZero: true,
                  ticks: {
                      autoSkip: false,
                      maxRotation: 45,
                      minRotation: 45
                  }
              },
              y: {
                  beginAtZero: true,
                  title: {
                      display: true,
                      text: 'Count / Percentage'
                  }
              }
          }
      }
  });

  function toggleRules() {
      const rulesContainer = document.getElementById('rulesContainer');
      rulesContainer.style.display = rulesContainer.style.display === 'none' || !rulesContainer.style.display ? 'block' : 'none';
    }
</script>

</body>
<!-- Footer -->
<footer>
    <p>Falco Team</p>
    <p>Mercado Libre - Observability Security</p>
    <p>&copy; 2024</p>
</footer>
</html>
