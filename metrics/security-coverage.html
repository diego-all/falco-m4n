<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Falcom4n</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .navbar-center {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
    }
    .navbar-end {
      margin-left: auto;
    }
    footer {
        background-color: #000000;
        color: white;
        padding: 20px 0;
        text-align: center;
    }
    footer img {
        max-width: 100px;
        margin-bottom: 10px;
    }
    footer p {
        margin: 0;
    }
    .metric-label {
      font-size: 2rem;
      font-weight: bold;
      color: #4CAF50; /* Verde */
      text-align: center;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">Falcom4n</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNavDropdown">
        <ul class="navbar-nav navbar-center">
          <li class="nav-item"><a class="nav-link active" aria-current="page" href="../index.html">Home</a></li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="infoDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Info</a>
            <ul class="dropdown-menu" aria-labelledby="infoDropdown">
              <li><a class="dropdown-item" href="#">What Is Falco</a></li>
              <li><a class="dropdown-item" href="#">Why Falco</a></li>
            </ul>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="rulesDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Rules</a>
            <ul class="dropdown-menu" aria-labelledby="rulesDropdown">
              <li><a class="dropdown-item" href="community-rules.html">Community Rules</a></li>
              <li><a class="dropdown-item" href="custom-rules.html">Custom Rules</a></li>
              <li><a class="dropdown-item" href="vendor-rules.html">Vendor Rules</a></li>
            </ul>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="metricsDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Metrics</a>
            <ul class="dropdown-menu" aria-labelledby="metricsDropdown">
              <li><a class="dropdown-item" href="statistics.html">Statistics</a></li>
              <li><a class="dropdown-item" href="security-coverage.html">Security Coverage</a></li>
              <li><a class="dropdown-item" href="maturity.html">Maturity</a></li>
            </ul>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="securityDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Security</a>
            <ul class="dropdown-menu" aria-labelledby="securityDropdown">
              <li><a class="dropdown-item" href="#">Threats</a></li>
              <li><a class="dropdown-item" href="#">Bypasses</a></li>
              <li><a class="dropdown-item" href="#">Challenges</a></li>
            </ul>
          </li>
        </ul>
        <ul class="navbar-nav navbar-end">
          <li class="nav-item"><a class="nav-link" href="#">About</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Content Section -->
  <div class="container mt-5">
    <h1>Security Coverage</h1>
    <p>How well Falco's rules cover potential attack vectors.</p>



        <!-- Indicador de métrica -->
        <div class="mt-5">
          <h3>Security coverage based on MITRE tactics</h3>
          <div class="metric-label">86.66%</div>
        </div>

    <!-- Button to Toggle MITRE Table -->
    <div class="mt-4 text-center">
      <button id="toggleButton" class="btn btn-primary">Show MITRE Table</button>
    </div>

    <!-- MITRE Table -->
    <div id="mitreTable" class="mt-4" style="display: none;">
      <h2>Falco MITRE Rule Matrix</h2>
      <table>
          <thead>
              <tr>
                  <th>Execution</th>
                  <th>Persistence</th>
                  <th>Privilege Escalation</th>
                  <th>Defense Evasion</th>
                  <th>Credential Access</th>
                  <th>Discovery</th>
                  <th>Lateral Movement</th>
                  <th>Exfiltration</th>
              </tr>
          </thead>
          <tbody>
              <tr>
                  <td>DB program spawned process</td>
                  <td>Modify Shell Configuration File</td>
                  <td>Launch Privileged Container</td>
                  <td>Clear Log Activities</td>
                  <td>Read sensitive file trusted after startup</td>
                  <td>Read Shell Configuration File</td>
                  <td>Launch Privileged Container</td>
                  <td>System procs network activity</td>
              </tr>
              <tr>
                  <td>Run shell untrusted</td>
                  <td>Schedule Cron Jobs</td>
                  <td>Non sudo setuid</td>
                  <td>Delete Bash History</td>
                  <td>Read sensitive file untrusted</td>
                  <td>Read ssh information</td>
                  <td>Launch Sensitive Mount Container</td>
                  <td>Interpreted procs inbound network activity</td>
              </tr>
              <tr>
                  <td>Terminal shell in container</td>
                  <td>Update Package Repository</td>
                  <td>Search Private Keys or Passwords</td>
                  <td>Read sensitive file untrusted</td>
                  <td></td>
                  <td>Launch Disallowed Container</td>
                  <td>Interpreted procs outbound network activity</td>
                  <td></td>
              </tr>
              <tr>
                  <td>Netcat Remote Code Execution in Container</td>
                  <td>Write below binary dir</td>
                  <td>Write below monitored dir</td>
                  <td></td>
                  <td></td>
                  <td>Contact K8S API Server From Container</td>
                  <td>Unexpected UDP Traffic</td>
                  <td></td>
              </tr>
              <tr>
                  <td>Write below etc</td>
                  <td>Write below root</td>
                  <td>Write below rpm database</td>
                  <td>Launch Suspicious Network Tool in Container</td>
                  <td></td>
                  <td></td>
                  <td>Launch Suspicious Network Tool in Container</td>
                  <td></td>
              </tr>
              <tr>
                  <td>Modify binary dirs</td>
                  <td>Mkdir binary dirs</td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td>Launch Suspicious Network Tool on Host</td>
                  <td></td>
              </tr>
              <tr>
                  <td>Launch Suspicious Network Tool on Host</td>
                  <td>User mgmt binaries</td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
              </tr>
              <tr>
                  <td>Create files below dev</td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td>Remove Bulk Data from Disk</td>
              </tr>
              <tr>
                  <td>Launch Package Management Process in Container</td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td>Set</td>
              </tr>
              <tr>
                  <td>Create Hidden Files or Directories</td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
              </tr>
              <tr>
                  <td>Setuid or Setgid bit</td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
              </tr>
          </tbody>
      </table>
      <p>To learn more about Falco, visit the <a href="https://falco.org/">homepage</a> or get started on <a href="https://github.com/falcosecurity/falco">GitHub</a>!</p>
    </div>

    <h3>Security coverage based on detection surface</h3>
    <p>Esta es una sección donde puedes agregar una tabla o cualquier otro contenido.</p>

    <div class="container my-5">
      <h2 class="text-center">Rules Coverage</h2>
      
      <!-- Botón para mostrar/ocultar la tabla -->
      <div class="mt-4 text-center">
        <button id="toggleCoverageButton" class="btn btn-primary">Coverage Based Detection Surface</button>
      </div>

      
      <!-- Tabla Rules Coverage -->
      <div id="rulesCoverageTable" class="table-responsive" style="display: none;">
        <table class="table table-striped table-bordered text-center">
          <thead class="table-dark">
            <tr>
              <th>Primary Attack Surface</th>
              <th>Number of Rules</th>
              <th>Coverage (%)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>filesystem</td>
              <td>12</td>
              <td>31.58%</td>
            </tr>
            <tr>
              <td>database</td>
              <td>1</td>
              <td>2.63%</td>
            </tr>
            <tr>
              <td>shell</td>
              <td>1</td>
              <td>2.63%</td>
            </tr>
            <tr>
              <td>container</td>
              <td>8</td>
              <td>21.05%</td>
            </tr>
            <tr>
              <td>users</td>
              <td>3</td>
              <td>7.89%</td>
            </tr>
            <tr>
              <td>network</td>
              <td>8</td>
              <td>21.05%</td>
            </tr>
            <tr>
              <td>process</td>
              <td>5</td>
              <td>13.16%</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    

  </div>

  <!-- Radar Chart Section -->
<div class="container mt-5">
  <h3>Rules Coverage by Primary Attack Surface</h3>
  <div style="width: 350px; height: 350px; margin: auto;">
    <canvas id="radarChart"></canvas>
  </div>
</div>


  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // document.getElementById('toggleButton').addEventListener('click', function () {
    //   const mitreTable = document.getElementById('mitreTable');
    //   if (mitreTable.style.display === 'none') {
    //     mitreTable.style.display = 'block';
    //     this.textContent = 'Hide MITRE Table';
    //   } else {
    //     mitreTable.style.display = 'none';
    //     this.textContent = 'Show MITRE Table';
    //   }
    // });

      // Mostrar/ocultar la tabla de "MITRE"
  document.getElementById('toggleButton').addEventListener('click', function () {
    const mitreTable = document.getElementById('mitreTable');
    mitreTable.style.display = mitreTable.style.display === 'none' ? 'block' : 'none';
  });


      // Mostrar/ocultar la tabla de "Rules Coverage"
  document.getElementById('toggleCoverageButton').addEventListener('click', function () {
    const rulesCoverageTable = document.getElementById('rulesCoverageTable');
    rulesCoverageTable.style.display = rulesCoverageTable.style.display === 'none' ? 'block' : 'none';
  });


  const ctx = document.getElementById('radarChart').getContext('2d');
  
  const radarChart = new Chart(ctx, {
    type: 'radar',
    data: {
      labels: ['filesystem', 'database', 'shell', 'container', 'users', 'network', 'process'], // Labels from the table
      datasets: [{
        label: 'Coverage (%)',
        data: [31.58, 2.63, 2.63, 21.05, 7.89, 21.05, 13.16], // Coverage values from the table
        backgroundColor: 'rgba(117, 182, 182, 0.5)', // Color de fondo uniforme
        borderColor: '#75b6b6', // Color del borde uniforme
        borderWidth: 2
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      elements: {
        line: {
          tension: 0.1 // Suaviza las líneas
        }
      },
      scale: {
        ticks: {
          beginAtZero: true,
          max: 35, // Ajustado para cubrir el rango máximo de la tabla
          stepSize: 5 // Escalado más claro
        }
      },
      plugins: {
        legend: {
          position: 'top'
        }
      }
    }
  });
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
<footer>
  <p>Falco Team</p>
  <p>Mercado Libre - Observability Security</p>
  <p>&copy; 2024</p>
</footer>
</html>
